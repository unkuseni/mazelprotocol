# ============================================================================
# MazelProtocol Draw Lifecycle Bot — Environment Configuration
# ============================================================================
# This bot runs as a Cloudflare Worker. Most variables are set in wrangler.toml
# under [vars]. Secrets are set via `wrangler secret put <NAME>`.
#
# This file documents ALL configuration options for reference.

# ---------------------------------------------------------------------------
# Solana Connection (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# RPC endpoint URL (required)
# Devnet:    https://api.devnet.solana.com
# Mainnet:   https://api.mainnet-beta.solana.com (or your preferred RPC provider)
RPC_URL=https://api.devnet.solana.com

# Commitment level: processed | confirmed | finalized (default: confirmed)
COMMITMENT=confirmed

# ---------------------------------------------------------------------------
# Authority Wallet (SECRET — set via `wrangler secret put`)
# ---------------------------------------------------------------------------

# JSON array of the authority keypair bytes (required)
# Example: [174,47,154,16,202,193,...,72]
# Set with: wrangler secret put AUTHORITY_KEYPAIR_JSON
# Then paste the JSON array when prompted.
#
# To get your keypair bytes from a Solana CLI keypair file:
#   cat ~/.config/solana/id.json
# AUTHORITY_KEYPAIR_JSON=[1,2,3,...,255]

# ---------------------------------------------------------------------------
# Telegram Bot (SECRETS — set via `wrangler secret put`)
# ---------------------------------------------------------------------------

# Telegram bot token from @BotFather (required)
# Set with: wrangler secret put TELEGRAM_BOT_TOKEN
# TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrSTUvwxYZ

# Telegram chat ID for notifications and commands (required)
# Can be a user ID, group ID, or channel ID.
# To find your chat ID, message @userinfobot on Telegram.
# Set with: wrangler secret put TELEGRAM_CHAT_ID
# TELEGRAM_CHAT_ID=123456789

# Comma-separated list of authorized Telegram user IDs that can send commands.
# If empty, only TELEGRAM_CHAT_ID is authorized.
# Set with: wrangler secret put TELEGRAM_ADMIN_IDS
# TELEGRAM_ADMIN_IDS=123456789,987654321

# ---------------------------------------------------------------------------
# Program IDs (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Main lottery program ID (required)
MAIN_PROGRAM_ID=7WyaHk2u8AgonsryMpnvbtp42CfLJFPQpyY5p9ys6FiF

# Quick Pick Express program ID (required)
QP_PROGRAM_ID=7XC1KT5mvsHHXbR2mH6er138fu2tJ4L2fAgmpjLnnZK2

# ---------------------------------------------------------------------------
# Switchboard Configuration (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Switchboard on-demand queue public key (required for commit_randomness)
SWITCHBOARD_QUEUE=

# Switchboard program ID (usually the default on-demand program)
# Leave blank to use the SDK default
SWITCHBOARD_PROGRAM_ID=

# ---------------------------------------------------------------------------
# USDC Mint (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# USDC mint address (required)
# Mainnet: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v
# Devnet:  4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU
USDC_MINT=

# ---------------------------------------------------------------------------
# Bot Behavior (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Which lotteries to operate (default: both)
#   both       — run draw lifecycle for Main Lottery AND Quick Pick Express
#   main-only  — only Main Lottery
#   qp-only    — only Quick Pick Express
MODE=both

# Delay in milliseconds between commit and execute to allow randomness reveal (default: 4000)
# Switchboard typically reveals within 1–2 slots (~400–800ms) but we add buffer.
# In the Worker model, this determines whether to proceed with execute in the
# same cron tick or wait for the next one.
COMMIT_EXECUTE_DELAY_MS=4000

# Maximum retries for each phase before skipping to error recovery (default: 3)
MAX_RETRIES=3

# Delay between retries in milliseconds (default: 2000)
RETRY_DELAY_MS=2000

# If true, the bot will log what it *would* do without sending transactions
DRY_RUN=false

# ---------------------------------------------------------------------------
# Indexer Configuration (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Maximum number of getProgramAccounts results to fetch per RPC call (default: 1000)
GPA_BATCH_SIZE=1000

# ---------------------------------------------------------------------------
# Logging (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Log level: trace | debug | info | warn | error | fatal (default: info)
# Worker logs are viewable via `wrangler tail` or the Cloudflare dashboard.
LOG_LEVEL=info

# ---------------------------------------------------------------------------
# Transaction Settings (set in wrangler.toml [vars])
# ---------------------------------------------------------------------------

# Priority fee in micro-lamports per compute unit (default: 1000)
PRIORITY_FEE_MICRO_LAMPORTS=1000

# Compute unit limit override (default: let the runtime decide)
# COMPUTE_UNIT_LIMIT=400000

# Skip preflight simulation (default: false)
SKIP_PREFLIGHT=false

# Transaction confirmation timeout in milliseconds (default: 60000)
TX_CONFIRM_TIMEOUT_MS=60000

# ---------------------------------------------------------------------------
# Cloudflare Worker Notes
# ---------------------------------------------------------------------------
#
# CRON SCHEDULE:
#   The polling interval is controlled by the cron trigger in wrangler.toml.
#   Default is "* * * * *" (every minute). Adjust in wrangler.toml [triggers].
#
# KV NAMESPACE:
#   The bot uses Cloudflare KV to persist draw state between invocations.
#   Create with: npm run kv:create
#   Then add the returned namespace ID to wrangler.toml.
#
# SECRETS:
#   Set secrets with:
#     npm run secret:keypair        # paste your keypair JSON array
#     npm run secret:telegram-token # paste your bot token
#     npm run secret:telegram-chat  # paste your chat ID
#
# TELEGRAM WEBHOOK:
#   After deploying, set the Telegram webhook:
#     npm run telegram:set-webhook
#   Or manually:
#     curl "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://<WORKER>.workers.dev/telegram"
#
# DEPLOYMENT:
#   npm run deploy              # deploy to default environment
#   npm run deploy:production   # deploy to production
#
# MONITORING:
#   npm run tail                # live tail Worker logs
